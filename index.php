<?php
$datas = [
  'User_Id' => '70590a02a99e1c061eac0318af82a7ae',
  'client' => [
    'nom' => [
      'value' => 'Paoletti',
      'label' => 'Nom',
      'type' => 'text',
      'required' => 1,
    ],
    'prenom' => [
      'value' => 'Pierre',
      'label' => 'Prènom',
      'type' => 'text',
      'required' => 1,
    ],
    'adresse' => [
      'value' => '42 b cours napoléon',
      'label' => 'Adresse',
      'type' => 'text',
    ],
    'telephone' => [
      'value' => '0634171081',
      'label' => 'Telephone',
      'type' => 'tel',
    ],
    'mail' => [
      'value' => 'pierre.paoletti1@gmail.com',
      'label' => 'E-Mail',
      'type' => 'email',
    ],
    'provenance' => [
      'value' => 'test',
      'label' => 'Provenance',
      'type' => 'text',
    ],
    'dateRdv' => [
      'value' => '2022-06-26',
      'label' => 'Date',
      'type' => 'date',
    ],
  ],
  'matiere' => 'ALU',
  'adresseChantier' => '42 b cours napoléon',
  'observation' => 'test orservations',
  'tableau' => [
    0 => [
      'repere' => [
        'value' => 1,
        'type' => 'number',
      ],
      'hauteur' => [
        'value' => 2,
        'type' => 'number',
      ],
      'largeur' => [
        'value' => 3,
        'type' => 'number',
      ],
      'largeurEmbras' => [
        'value' => 4,
        'type' => 'number',
      ],
      'quantite' => [
        'value' => 5,
        'type' => 'number',
      ],
      'dorm' => [
        'value' => 6,
        'type' => 'number',
      ],
      'type' => [
        'value' => 7,
        'type' => 'text',
      ],
      'aile' => [
        'value' => 8,
        'type' => 'text',
      ],
      'allege' => [
        'value' => 9,
        'type' => 'text',
      ],
      'vitrage' => [
        'value' => 10,
        'type' => 'text',
      ],
      'VMC' => [
        'value' => 11,
        'type' => 'text',
      ],
      'seuil' => [
        'value' => 12,
        'type' => 'text',
      ],
      'pBois' => [
        'value' => 13,
        'type' => 'text',
      ],
      'largTapee' => [
        'value' => 14,
        'type' => 'text',
      ],
      'hautSoubass' => [
        'value' => 15,
        'type' => 'text',
      ],
      'quincall' => [
        'value' => 16,
        'type' => 'text',
      ],
      'habitInt' => [
        'value' => 17,
        'type' => 'text',
      ],
      'VR' => [
        'value' => 18,
        'type' => 'text',
      ],
      'divers' => [
        'value' => 19,
        'type' => 'text',
      ],
    ],
    1 => [
      'repere' => [
        'value' => 1,
        'type' => 'number',
      ],
      'hauteur' => [
        'value' => 2,
        'type' => 'number',
      ],
      'largeur' => [
        'value' => 3,
        'type' => 'number',
      ],
      'largeurEmbras' => [
        'value' => 4,
        'type' => 'number',
      ],
      'quantite' => [
        'value' => 5,
        'type' => 'number',
      ],
      'dorm' => [
        'value' => 6,
        'type' => 'number',
      ],
      'type' => [
        'value' => 7,
        'type' => 'text',
      ],
      'aile' => [
        'value' => 8,
        'type' => 'text',
      ],
      'allege' => [
        'value' => 9,
        'type' => 'text',
      ],
      'vitrage' => [
        'value' => 10,
        'type' => 'text',
      ],
      'VMC' => [
        'value' => 11,
        'type' => 'text',
      ],
      'seuil' => [
        'value' => 12,
        'type' => 'text',
      ],
      'pBois' => [
        'value' => 13,
        'type' => 'text',
      ],
      'largTapee' => [
        'value' => 36,
        'type' => 'text',
      ],
      'hautSoubass' => [
        'value' => 75,
        'type' => 'text',
      ],
      'quincall' => [
        'value' => 16,
        'type' => 'text',
      ],
      'habitInt' => [
        'value' => 17,
        'type' => 'text',
      ],
      'VR' => [
        'value' => 18,
        'type' => 'text',
      ],
      'divers' => [
        'value' => 19,
        'type' => 'text',
      ],
    ],
    2 => [
      'repere' => [
        'value' => 1,
        'type' => 'number',
      ],
      'hauteur' => [
        'value' => 2,
        'type' => 'number',
      ],
      'largeur' => [
        'value' => 3,
        'type' => 'number',
      ],
      'largeurEmbras' => [
        'value' => 4,
        'type' => 'number',
      ],
      'quantite' => [
        'value' => 5,
        'type' => 'number',
      ],
      'dorm' => [
        'value' => 6,
        'type' => 'number',
      ],
      'type' => [
        'value' => 7,
        'type' => 'text',
      ],
      'aile' => [
        'value' => 8,
        'type' => 'text',
      ],
      'allege' => [
        'value' => 9,
        'type' => 'text',
      ],
      'vitrage' => [
        'value' => 10,
        'type' => 'text',
      ],
      'VMC' => [
        'value' => 11,
        'type' => 'text',
      ],
      'seuil' => [
        'value' => 12,
        'type' => 'text',
      ],
      'pBois' => [
        'value' => 13,
        'type' => 'text',
      ],
      'largTapee' => [
        'value' => 14,
        'type' => 'text',
      ],
      'hautSoubass' => [
        'value' => 15,
        'type' => 'text',
      ],
      'quincall' => [
        'value' => 16,
        'type' => 'text',
      ],
      'habitInt' => [
        'value' => 17,
        'type' => 'text',
      ],
      'VR' => [
        'value' => 18,
        'type' => 'text',
      ],
      'divers' => [
        'value' => 19,
        'type' => 'text',
      ],
    ],
    3 => [
      'repere' => [
        'value' => 1,
        'type' => 'number',
      ],
      'hauteur' => [
        'value' => 2,
        'type' => 'number',
      ],
      'largeur' => [
        'value' => 3,
        'type' => 'number',
      ],
      'largeurEmbras' => [
        'value' => 4,
        'type' => 'number',
      ],
      'quantite' => [
        'value' => 5,
        'type' => 'number',
      ],
      'dorm' => [
        'value' => 6,
        'type' => 'number',
      ],
      'type' => [
        'value' => 7,
        'type' => 'text',
      ],
      'aile' => [
        'value' => 8,
        'type' => 'text',
      ],
      'allege' => [
        'value' => 9,
        'type' => 'text',
      ],
      'vitrage' => [
        'value' => 10,
        'type' => 'text',
      ],
      'VMC' => [
        'value' => 11,
        'type' => 'text',
      ],
      'seuil' => [
        'value' => 12,
        'type' => 'text',
      ],
      'pBois' => [
        'value' => 13,
        'type' => 'text',
      ],
      'largTapee' => [
        'value' => 14,
        'type' => 'text',
      ],
      'hautSoubass' => [
        'value' => 15,
        'type' => 'text',
      ],
      'quincall' => [
        'value' => 16,
        'type' => 'text',
      ],
      'habitInt' => [
        'value' => 17,
        'type' => 'text',
      ],
      'VR' => [
        'value' => 18,
        'type' => 'text',
      ],
      'divers' => [
        'value' => 19,
        'type' => 'text',
      ],
    ],
    4 => [
      'repere' => [
        'value' => 1,
        'type' => 'number',
      ],
      'hauteur' => [
        'value' => 2,
        'type' => 'number',
      ],
      'largeur' => [
        'value' => 3,
        'type' => 'number',
      ],
      'largeurEmbras' => [
        'value' => 4,
        'type' => 'number',
      ],
      'quantite' => [
        'value' => 5,
        'type' => 'number',
      ],
      'dorm' => [
        'value' => 6,
        'type' => 'number',
      ],
      'type' => [
        'value' => 7,
        'type' => 'text',
      ],
      'aile' => [
        'value' => 8,
        'type' => 'text',
      ],
      'allege' => [
        'value' => 9,
        'type' => 'text',
      ],
      'vitrage' => [
        'value' => 10,
        'type' => 'text',
      ],
      'VMC' => [
        'value' => 11,
        'type' => 'text',
      ],
      'seuil' => [
        'value' => 12,
        'type' => 'text',
      ],
      'pBois' => [
        'value' => 13,
        'type' => 'text',
      ],
      'largTapee' => [
        'value' => 14,
        'type' => 'text',
      ],
      'hautSoubass' => [
        'value' => 15,
        'type' => 'text',
      ],
      'quincall' => [
        'value' => 1645487878797,
        'type' => 'text',
      ],
      'habitInt' => [
        'value' => 17,
        'type' => 'text',
      ],
      'VR' => [
        'value' => 18,
        'type' => 'text',
      ],
      'divers' => [
        'value' => 19,
        'type' => 'text',
      ],
    ],
  ],
];

[
  "User_Id" => $user_id, //string
  "client" => $client, //tableau
  "matiere" => $matiere, //string
  "tableau" => $tableau, //tableau des cotes
  "adresseChantier" => $adresseChantier, //string
  "observation" => $observation, // string
] = $datas;

$tableHead = array_keys($tableau[0]);

function get_th_values($tableau, $key)
{
  $return_values = array();
  for ($i = 0; $i < count($tableau); $i++) {
    if (isset($tableau[$i][$key])) {
      $return_values[] = $tableau[$i][$key]["value"];
    }
  }
  return $return_values;
}



?>

<!DOCTYPE html>
<html lang="fr">


<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demande de devis</title>
</head>

<style>
  * {
    box-sizing: border-box;
  }

  .main-header {
    border: 2px solid black;
    margin: 22px;
  }

  .separator {
    border: 1px solid black;
    margin: 12px 0;
  }

  .section {
    border: 2px solid black;
    margin: 22px auto;
    color: black;
    text-align: center;
  }

  .infos {
    border: none;
  }

  .utils {
    display: inline-block;
    width: 100%;
  }

  .right {
    text-align: right;
  }

  .left {
    text-align: left;
  }

  .row {
    margin: 8px;
    padding: 8px;
    font-size: 1.5em;
    width: 45%;
    display: inline-block;
    vertical-align: top;
  }

  .tableau {
    font-size: 1.2em;
  }

  table {
    margin: 0 auto;
  }

  .observations {
    height: 200px;
    font-size: 1.5em;
  }

  th {
    max-width: fit-content;
    text-align: left;
    text-transform: uppercase;
  }

  td {
    font-size: 1.2em;
    min-width: 30px;
    text-align: right;
  }
</style>

<body>
  <header class="main-header section">
    <div class="entry-content row left">
      <span class="infos">
        <strong>Nom : </strong><?= $client["nom"]["value"] ?>
      </span>
      <div class="separator"></div>
      <span class="infos">
        <strong>Prénom : </strong><?= $client["prenom"]["value"] ?>
      </span>
      <div class="separator"></div>
    </div>
    <div class="entry-content row right">
      <span class="infos utils">
        <strong>Adresse : </strong><?= $client["adresse"]["value"] ?>
      </span>
      <div class="separator"></div>
      <span class="infos utils">
        <strong>Tel : </strong><?= $client["telephone"]["value"] ?>
      </span>
      <div class="separator"></div>
      <span class="infos utils">
        <strong>Mail : </strong><?= $client["mail"]["value"] ?>
      </span>
    </div>
    <div class="separator"></div>
    <div class="entry-content row">
      <span class="infos utils">
        <strong>Provenance : </strong><?= $client["provenance"]["value"] ?>
      </span>
      <div class="separator"></div>
      <span class="infos utils">
        <strong>Date : </strong><?= date("d-m-Y", strtotime($client["dateRdv"]["value"])) ?>
      </span>
    </div>
  </header>
  <div class="separator"></div>
  <main>

    <section class="section infos">
      <div class="row row-infos matiere">
        <label for="ALU">ALU</label>
        <input type="radio" name="matiere" id="ALU" <?= $matiere == "ALU" ?  'checked' : '' ?>>
        <label for="BOIS">BOIS</label>
        <input type="radio" name="matiere" id="BOIS" <?= $matiere == "BOIS" ?  'checked' : '' ?>>
        <label for="MIXTE">MIXTE</label>
        <input type="radio" name="matiere" id="MIXTE" <?= $matiere == "MIXTE" ?  'checked' : '' ?>>
        <label for="PVC">PVC</label>
        <input type="radio" name="matiere" id="PVC" <?= $matiere == "PVC" ?  'checked' : '' ?>>
      </div>
      <div class="row row-infos">
        <span><strong>Adresse Chantier : </strong><?= $adresseChantier ?></span>
      </div>
    </section>

    <div class="separator"></div>

    <section class="section tableau infos">
      <table border="1" style="table-layout:auto">
        <thead>
          <tr>
            <th class="column"></th>
            <?php for ($i = 0; $i < count($tableau); $i++) : ?>
              <th style="text-align:center"><?= $i + 1 ?></th>
            <?php endfor; ?>
          </tr>
        </thead>
        <?php foreach ($tableHead as $value) : ?>
          <tr>
            <th scope="row"><?= $value ?></th>
            <?php foreach (get_th_values($tableau, $value) as $v) : ?>
              <td><?= $v ?></td>
            <?php endforeach; ?>
          </tr>
        <?php endforeach; ?>
      </table>
    </section>

    <div class=" separator">
    </div>

    <section class="observations section left">
      <div>
        <span><strong>Observations : </strong><?= $observation ?></span>
      </div>
    </section>
  </main>
</body>

</html>